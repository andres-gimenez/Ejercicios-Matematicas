name: Build Typst document (CI)
on: 
  push:
    paths: 
    - '.github/workflows/build.yaml'
    - 'Material/**/*.typ'
    - 'Material/**/*.yaml'
    - 'Material/**/*.toml'

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v5
     
      - name: Delete samples and test
        run: |
          rm -rf ./Material/*.pdf
      
      - uses: typst-community/setup-typst@v4

      - name: Compile Typst examples to PDF
        shell: bash
        run: |
          for archivo in ./Material/**/*.typ; do
              echo "$archivo"
              typst compile "$archivo" --root . --input show-solutions=true || true
              
              if [ $? -eq 0 ]; then
                  echo "Compilaci√≥n exitosa: $archivo"
              else
                  echo "Error al compilar: $archivo"
              fi
          done

      - name: Upload PDF file
        uses: actions/upload-artifact@v4
        with:
          name: Material
          path: ./Material/**/*.pdf
